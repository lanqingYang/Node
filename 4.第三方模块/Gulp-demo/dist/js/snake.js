"use strict";var pingmu=document.getElementById("pingmu"),btn=document.getElementById("btn"),snakeMove=null,scoreBox=document.getElementById("score");function init(){this.mapW=parseInt(getComputedStyle(pingmu).width),this.mapH=parseInt(getComputedStyle(pingmu).height),console.log(this.mapW),console.log(this.mapH),this.foodW=20,this.foodH=20,this.snakeW=20,this.snakeH=20,this.foodX=0,this.foodY=0,this.snakeBody=[[2,0,"head"],[1,0,"body"],[0,0,"body"]],this.fangxiang="right",this.left=!1,this.right=!1,this.up=!0,this.down=!0,this.score=0,this.speed=100,food(),snake()}function startGame(){snakeMove=setInterval(move,this.speed),bindKeyDown()}function bindKeyDown(){window.onkeydown=function(s){switch(code=s.keyCode,code){case 37:this.left&&(this.fangxiang="left",this.left=!1,this.right=!1,this.up=!0,this.down=!0);break;case 38:this.up&&(this.fangxiang="up",this.left=!0,this.right=!0,this.up=!1,this.down=!1);break;case 39:this.right&&(this.fangxiang="right",this.left=!1,this.right=!1,this.up=!0,this.down=!0);break;case 40:this.down&&(this.fangxiang="down",this.left=!0,this.right=!0,this.up=!1,this.down=!1)}}}function pauseGame(){clearInterval(snakeMove)}function move(){for(var s=this.snakeBody.length-1;0<s;s--)this.snakeBody[s][0]=this.snakeBody[s-1][0],this.snakeBody[s][1]=this.snakeBody[s-1][1];switch(this.fangxiang){case"left":this.snakeBody[0][0]-=1;break;case"right":this.snakeBody[0][0]+=1;break;case"up":this.snakeBody[0][1]-=1;break;case"down":this.snakeBody[0][1]+=1}if(clearBox("snake"),snake(),this.snakeBody[0][0]==this.foodX&&this.snakeBody[0][1]==this.foodY){clearBox("food"),food(),this.score+=10,console.log(speed),10!=this.speed&&(this.speed-=10,clearInterval(snakeMove),snakeMove=setInterval(move,this.speed)),scoreBox.innerHTML=this.score;var t=this.snakeBody[this.snakeBody.length-1][0],e=this.snakeBody[this.snakeBody.length-1][1];switch(this.fangxiang){case"left":this.snakeBody.push([t+1,e,"body"]);break;case"right":this.snakeBody.push([t-1,e,"body"]);break;case"up":this.snakeBody.push([t,e+1,"body"]);break;case"down":this.snakeBody.push([t,e-1,"body"])}}(this.snakeBody[0][0]<0||this.snakeBody[0][0]>=this.mapW/this.foodW)&&gameOver(),(this.snakeBody[0][1]<0||this.snakeBody[0][1]>=this.mapH/this.foodH)&&gameOver();for(s=1;s<this.snakeBody.length;s++)this.snakeBody[s][0]==this.snakeBody[0][0]&&this.snakeBody[s][1]==this.snakeBody[0][1]&&gameOver()}function gameOver(){alert("游戏结束,当前得分："+this.score),clearInterval(snakeMove),clearBox("snake"),this.snakeBody=[[2,0,"head"],[1,0,"body"],[0,0,"body"]],this.fangxiang="right",this.left=!1,this.right=!1,this.up=!0,this.down=!0,this.score=0,this.speed=100,snake(),btn.innerHTML="开始",scoreBox.innerHTML=this.score}function clearBox(s){for(var t=document.getElementsByClassName(s);t.length;)t[0].parentNode.removeChild(t[0])}function snake(){for(var s=0;s<this.snakeBody.length;s++){var t=document.createElement("div");t.style.width=snakeW+"px",t.style.height=snakeH+"px",t.style.position="absolute",t.style.top=this.snakeBody[s][1]*this.snakeW+"px",t.style.left=this.snakeBody[s][0]*this.snakeH+"px",t.className="snake",pingmu.appendChild(t)}}function food(){this.foodX=Math.floor(Math.random()*this.mapW/this.foodW),this.foodY=Math.floor(Math.random()*this.mapH/this.foodH);var s=document.createElement("div");s.style.width=this.foodW+"px",s.style.height=this.foodH+"px",s.style.position="absolute",s.style.top=this.foodY*this.foodH+"px",s.style.left=this.foodX*this.foodW+"px",s.className="food",pingmu.appendChild(s)}init(),btn.onclick=function(){"开始"==this.innerHTML?(startGame(),this.innerHTML="暂停"):"暂停"==this.innerHTML&&(pauseGame(),this.innerHTML="开始")};